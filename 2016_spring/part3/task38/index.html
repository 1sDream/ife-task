<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Task38 UI组件之排序表格</title>
    <style type="text/css">
    td {
        border: 1px solid black;
        width: 100px;
    }
    
    table {
        border-collapse: collapse;
        text-align: center;
    }
    </style>
</head>

<body>
    <div id="table"></div>
    <script type="text/javascript">
    var TableTool = {
        init: function(param) {
            var student = [];
            var Student = function(name, Chinese, Computer, English) {
                this.name = name;
                this.Chinese = Chinese;
                this.Computer = Computer;
                this.English = English;
            }

            student[0] = new Student("小明", 20, 90, 40);
            student[1] = new Student("小红", 90, 60, 90);
            student[2] = new Student("小虹", 60, 100, 70);

            data = {
                table_thead: ["姓名", "语文", "电脑", "英语"],
                student: student,
            }

            return data;

        },

        createTable: function() {
            this.init();
            var render = function() {
                var table = document.createElement("table");
                var thead = document.createElement("thead");
                var thead_tr = document.createElement("tr");

                var table_html = "";
                for (var i = 0; i < data.table_thead.length; i++) {
                    table_html += "<td name='" + data.table_thead[i] + "'>" + data.table_thead[i] + "<img src='arrow_up.png' id='sort" + data.table_thead[i] + "down'><img  src='arrow_down.png' id='sort" + data.table_thead[i] + "up'></td>";
                }

                thead.innerHTML = table_html;

                table.appendChild(thead);

                var tbody = document.createElement("tbody");

                var tbody_obj = {
                    1: data.student[0],
                    2: data.student[1],
                    3: data.student[2]
                };

                var tbody_html = "";
                for (var i = 1; i < data.table_thead.length; i++) {
                    tbody_html += "<tr><td>" + tbody_obj[i].name + "</td><td>" + tbody_obj[i].Chinese + "</td><td>" + tbody_obj[i].Computer + "</td><td>" + tbody_obj[i].English + "</td></tr>";
                }

                tbody.innerHTML = tbody_html;

                table.appendChild(tbody);

                document.getElementById("table").appendChild(table);


                document.getElementById("sort语文up").addEventListener("click", function() {
                    resetTable();
                    ascendingSort(data.student, "Chinese");
                    render();
                }, false);
                document.getElementById("sort电脑up").addEventListener("click", function() {
                    resetTable();
                    ascendingSort(data.student, "Computer");
                    render();
                }, false);
                document.getElementById("sort英语up").addEventListener("click", function() {
                    resetTable();
                    ascendingSort(data.student, "English");
                    render();
                }, false);
                document.getElementById("sort语文down").addEventListener("click", function() {
                    resetTable();
                    descendingSort(data.student, "Chinese");
                    render();
                }, false);
                document.getElementById("sort电脑down").addEventListener("click", function() {
                    resetTable();
                    descendingSort(data.student, "Computer");
                    render();
                }, false);
                document.getElementById("sort英语down").addEventListener("click", function() {
                    resetTable();
                    descendingSort(data.student, "English");
                    render();
                }, false);
                document.getElementsByTagName("thead")[0].childNodes[0].childNodes[0].removeChild(document.getElementsByTagName("thead")[0].childNodes[0].childNodes[0].childNodes[1]);
                document.getElementsByTagName("thead")[0].childNodes[0].childNodes[0].removeChild(document.getElementsByTagName("thead")[0].childNodes[0].childNodes[0].childNodes[1]);
            }
            render();

        },
    }

    TableTool.createTable();
    /**
     * 排序函数
     * @param  {array} data    要参照的数组
     * @param  {obj} courese 要参照的科目
     * @return {array}         返回排序好之后的数组
     */

    function ascendingSort(data, courese) {
        data.sort(function(a, b) {
            return a[courese] - b[courese];
        });
        return data;
    }

    function descendingSort(data, courese) {
        data.sort(function(a, b) {
            return b[courese] - a[courese];
        });
        return data;
    }


    function resetTable() {
        document.getElementById("table").innerHTML = "";
    }
    </script>
</body>

</html>
