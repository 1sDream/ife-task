<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>task21 基础JavaScript练习（四）</title>
    <style type="text/css">
    body {
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-flex-direction: column;
        -ms-flex-direction: column;
        flex-direction: column;
        -webkit-align-items: center;
        -ms-flex-align: center;
        align-items: center;
    }
    
    li {
        display: inline-block;
        background-color: rgba(255, 0, 0, 0.5);
        margin: 2px 2px;
        border-radius: 15px;
        padding: 7px;
        color: #fff;
        transition: all 1s;
    }
    
    li:hover {
        cursor: pointer;
    }
    
    ul {
        padding-left: 0;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-align-items: flex-end;
        -ms-flex-align: end;
        align-items: flex-end;
        -webkit-flex-wrap: wrap;
        -ms-flex-wrap: wrap;
        flex-wrap: wrap;
    }
    
    input {
        border: 1px #ff0000 solid;
        background-color: #fff;
        border-radius: 15px;
        padding: 20px;
        cursor: pointer;
        transition: all 0.5s;
    }
    
    input:hover {
        background-color: rgba(255, 0, 0, 0.5);
        transition: all 0.5s;
    }
    </style>
</head>

<body>
    <div>
        <label for="inputText">Tag:</label>
        <input type="text" placeholder="新建标签，可以按回车，逗号，空格完成创建" id="inputText" onkeyup="add(event)">
        <input type="button" value="添加" id="inputLeftIn">
        <ul id="content"></ul>
        <textarea placeholder="批量输入多个内容，格式可以为数字、中文、英文等，可以通过用回车，逗号（全角半角均可），顿号，空格（全角半角、Tab等均可）等符号作为不同内容的间隔。" id="searchInput" cols="100" rows="5"></textarea>
        <input type="button" value="查询" id="searchBtn">
        <input type="button" value="重置" id="resetBtn">
    </div>
    <script type="text/javascript">
    var txt = document.getElementById('inputText');
    var content = document.getElementById("content");

    //添加
    function add(event) {
        var e = e||event;
        if(e.keyCode==13||e.keyCode==32||e.keyCode==188){
        var value = document.getElementById('inputText').value;
        if(value.charAt(value.length-1).toString() == ","){value = value.slice(0,value.length-1)};//消除逗号输入后逗号残留的BUG
        if(value.charAt(0).toString() == ","){console.log(value.charAt(0).toString())}
        var liNum = content.childNodes.length;
            if (value != false) {//防止输入框为空
                console.log(value)
                var newItem = document.createElement("li");
                var textnode = document.createTextNode(value);
                newItem.appendChild(textnode);
                content.appendChild(newItem, content.childNodes[0]);
                newItem.setAttribute('title', value);
                newItem.setAttribute('onmouseover', 'showDelInfo()');//添加hover效果
                newItem.setAttribute('onmouseout', 'hideDelInfo()');//添加hover效果
                txt.value = "";
                if (liNum == 10) {//超过10个就call删除最早的函数
                    deleteOld();
                }
        }
    }
}

    //删除最左端，最早的Tag
    function deleteOld() {
        content.removeChild(content.childNodes[0]);
    }
   
    //hover效果
    function showDelInfo(e){
        var e= e||event;
        e.target.style.backgroundColor = "rgba(0, 255, 0, 0.5)";
        e.target.innerHTML = "点击删除"+e.target.innerHTML;
    }
    function hideDelInfo(e){
        var e = e||event;
        e.target.style.backgroundColor = "rgba(255, 0, 0, 0.5)";
        e.target.innerHTML = e.target.innerHTML.slice(4,e.target.innerHTML.length);
    }

    //给已出现的Li都添加点击事件
    content.addEventListener("click", function(e) {
        var e = e||event;
        content.removeChild(e.target);
    }, false)

    //正则过滤
    function getRegExp() {
        function getValue() {
            value = txt.value.replace(/[^\d\u4e00-\u9fa5a-zA-Z]+/g, " ").split(" ");
            if (value[0] !== "") {
                return value;
            } else {
                alert("请先输入点东西~");
                return false;
            }
        }
        getValue();
    }

    //查询按钮
    function searchItem() {
        var childLi = content.childNodes;
        var inputTxt = document.getElementById('searchInput').value;
        for (var i = 0; i < childLi.length; i++) {
            if (inputTxt == childLi[i].innerHTML) {
                childLi[i].style.backgroundColor = "#FFFF00";
                childLi[i].style.color = "#000";
            }
        }
    }

    //重置清空函数
    function reset() {
        content.innerHTML = "";
        txt.value = "";
    }


    document.getElementById("inputLeftIn").addEventListener("click", inputLeftIn, false);
    document.getElementById('searchBtn').addEventListener("click", searchItem, false);
    document.getElementById('resetBtn').addEventListener("click", reset, false)
    </script>
</body>

</html>
